---
title: "boxplots_AUC"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}

library(dplyr)
library(readr)
library(ggplot2)
library(reshape)
library(reshape)
library(ggrepel)
```


```{r}


AUCs_binary <- read.csv("~/GitHub/ML-assignments/assignment2/AUCs_binary.csv")
meltAUCs_binary <- melt(AUCs_binary)
meltAUCs_binary <- cbind(label=rep(seq(1,50),7),meltAUCs_binary)
colnames(meltAUCs_binary) <- c("label","Model","AUC")  
glimpse(meltAUCs_binary)
summary(meltAUCs_binary)
```



```{r }

classifier <- unique(meltAUCs_binary$Model)

quantiles <- apply(AUCs_binary, 2, 
                   function(x){
                     tail(sort(x),3)[1]
  
})
names(quantiles) <-classifier

#set labels to "_" when its value is greater than 3dr quantile
labels<- sapply(1:nrow(meltAUCs_binary), 
                function(i){
                  temp <-  meltAUCs_binary$Model[i]
                  if (meltAUCs_binary$AUC[i]  >= quantiles[temp]){
                    meltAUCs_binary$label[i]
                  }
                  else{
                    "_"
                  }
                  
                })
  
meltAUCs_binary <- cbind(meltAUCs_binary,plabel=labels)


 ggplot(meltAUCs_binary,aes(x=Model,y=AUC, fill = Model))+
  geom_boxplot()+
   geom_label_repel(
    label.padding = unit(0.15, "lines"),
      data=meltAUCs_binary %>% 
      filter(plabel!="_"), # 0.7161 is the 3rd quartile
   aes(label=label)) +
   theme_minimal() 



```


