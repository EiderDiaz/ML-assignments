function [v, best] = vic(D, psi, omega, k, RNG)
% Execute the clustering algorithm on the dataset
P = omega(D);

% Find cross-validation indices
rng(RNG)
fold_indxs = crossvalind('Kfold', size(D, 1), k);

% initialize best AUC seen for all classifiers
v = 0;

% for each classifier
for i = 1:length(psi)
    % initialize cross validation average AUC and best classifier seen
    v_current = 0;
    best = i;
    
    % for each fold of cross validation
    for j = 1:k
        test = (fold_indxs == j); % test set indices
        train = ~test; % training set indices
        model = psi{i}(D(train, :), P(train)); % train classifier
        [~, probs] = predict(model, D(test, :)); % get prediction scores
        classes = unique(P(test));
        nclasses = length(classes);
        
        if nclasses > 2 % multiclass problem
            AUC = 0; % variable to sum the AUC for all classes
            % for each class
            for c = 1:length(classes)
                [~, ~ , ~, tmp] = perfcurve(P(test), probs(:, c), c); % AUC
                AUC = AUC + tmp;
            end
        else
            [~, ~ , ~, AUC] = perfcurve(P(test), probs(:, 1), 1);
            v_current = vcurrent + AUC;
        end    
    end
    v_current = v_current / k;
    if v_current > v
        v = v_current;
        best = i;
    end
end

end